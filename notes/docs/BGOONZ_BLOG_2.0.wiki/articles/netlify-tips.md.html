<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>netlify-tips.md</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<h1 id="build-troubleshooting-tips">Build troubleshooting tips</h1>
<p>This article provides troubleshooting tips for failing builds in Netlify’s build service.</p>
<p>In case your build fails on Netlify, first make sure it builds locally in your own development environment. This is a prerequisite to all of the below suggestions.</p>
<p>If your build works locally, the next debugging step is to ensure the package versions we use to build match yours. You can find the settings for these in the <a href="https://docs.netlify.com/configure-builds/manage-dependencies/">dependency management</a> doc. That’s the leading cause of build failure.</p>
<p>Once you’ve considered the most frequently encountered issues listed below, there is some additional reading linked at the bottom of this article which may help you debug in more depth or find answers to less commonly asked questions.</p>
<h2 id="command-not-found"><a href="https://docs.netlify.com/configure-builds/troubleshooting-tips/?_ga=2.84803921.938315912.1639898242-345723907.1639767886#command-not-found">#</a>Command not found</h2>
<p>If your build fails with <code>jekyll: command not found</code> or <code>gulp: command not found</code> or anything in that pattern, it means that the software required for that command hasn’t been installed in your build. You can tell the buildbot to install the software you need by including the proper configuration file, like a <code>Gemfile</code> for Ruby programs like <code>jekyll</code>, or <code>package.json</code> for Node programs like <code>gulp</code>.</p>
<p>Check out the <a href="https://docs.netlify.com/configure-builds/manage-dependencies/">dependency management</a> doc for more details on how to tell us to install your toolchain. Once we find your configuration file, we’ll automatically use it before trying to run your build command.</p>
<p>Note that by default the buildbot looks for the configuration file in the root of your repository. If your configuration file is located in a subdirectory, you will need to change your folder structure or <a href="https://docs.netlify.com/configure-builds/get-started/#basic-build-settings">set the site’s base directory</a> to tell us which subdirectory to use.</p>
<h2 id="build-command-named-build"><a href="https://docs.netlify.com/configure-builds/troubleshooting-tips/?_ga=2.84803921.938315912.1639898242-345723907.1639767886#build-command-named-build">#</a>Build command named <code>build</code></h2>
<p>Don’t name your build command <code>build</code> or try to use the <a href="https://github.com/netlify/build-image#running-locally">debug build steps to run a build locally</a> in our production build environment. This will fail and give you a strange build log.</p>
<h2 id="build-fails-with-exit-status-128"><a href="https://docs.netlify.com/configure-builds/troubleshooting-tips/?_ga=2.84803921.938315912.1639898242-345723907.1639767886#build-fails-with-exit-status-128">#</a>Build fails with <code>exit status 128</code></h2>
<p>Typically this means that we don’t have permission to clone the repository you are trying to deploy. The usual cause for this is that someone made some changes to settings for the parent organization, or repository, some time after linking the repository to your site.</p>
<p>We only have permission to create a copy of your code when you link the repository. If you are seeing your build fail with <code>exit status 128</code> in the deploy log, relinking your repo using our UI is a good first attempt to fix things (go to Site settings &gt; Build &amp; deploy &gt; Continuous deployment &gt; Build settings, select Edit settings, then Link to a different repository). If you do this, please check your webhook settings at your Git provider to be sure you don’t have any duplicate Netlify webhooks.</p>
<p>Permission levels</p>
<p>Your GitHub, Bitbucket, or GitLab user account may not have the privilege level required to link the repo to Netlify, even if you can log in and access it from the Git host’s website. You generally need administrative privileges on the repository, owning organization, or both. Related: <a href="https://docs.netlify.com/configure-builds/repo-permissions-linking/">documentation about repository permissions and linking</a>.</p>
<h2 id="build-fails-on-warning-message"><a href="https://docs.netlify.com/configure-builds/troubleshooting-tips/?_ga=2.84803921.938315912.1639898242-345723907.1639767886#build-fails-on-warning-message">#</a>Build fails on warning message</h2>
<p>In some cases, a build may fail due to a warning message that would not cause a build failure when run locally. This is because some libraries and build tools handle warnings differently when they detect that they are being run in a Continuous Integration (CI) environment.</p>
<p>Like many other CI tools and platforms, Netlify sets a build environment variable, <code>CI=true</code>, as a convention to indicate that your build is running in an automated environment. Many libraries use the presence of the <code>CI</code> variable to trigger changes in their behavior, such as removing progress spinner animations or user prompts. In some cases, a library may also choose to treat warning messages as errors, failing the build.</p>
<p>Generally, libraries that choose to fail on warnings presume their users will want to fix the issues causing the warnings. If this isn’t practical for your use case, you can override the <code>CI</code> variable by adding <code>CI=''</code> to the beginning of your site <a href="https://docs.netlify.com/configure-builds/get-started/#basic-build-settings">build command</a>. For example:</p>
<pre><code>CI=&#39;&#39; npm run build
</code></pre>
<p>"False” isn’t always false</p>
<p>Though it seems like the logical opposite of <code>CI=true</code>, setting <code>CI=false</code> may not work as expected. This is because environment variable values are processed as strings, and many libraries interpret <em>any</em> non-empty string value for <code>CI</code> as <code>true</code>.</p>
<h2 id="case-sensitivity"><a href="https://docs.netlify.com/configure-builds/troubleshooting-tips/?_ga=2.84803921.938315912.1639898242-345723907.1639767886#case-sensitivity">#</a>Case sensitivity</h2>
<p>If you develop on Windows or OSX, and your code includes something like <code>jQuery/jquery.js</code> — the Netlify build may fail as the file system used in Netlify builds is case sensitive while your build environment is not. The error messages that result may not clearly indicate this!</p>
<p>To effectively change case of a file stored in Git from your case insensitive local environment, it may be necessary to <code>git mv</code> or <code>git rm</code> and then add the file again, as renaming and committing will not have the desired effect.</p>
<h2 id="large-files-or-sites"><a href="https://docs.netlify.com/configure-builds/troubleshooting-tips/?_ga=2.84803921.938315912.1639898242-345723907.1639767886#large-files-or-sites">#</a>Large files or sites</h2>
<p>Files over 10 MB in size are not well-supported by our CDN and may fail to upload to our system, causing your entire deploy to fail. You should host large content elsewhere, such as YouTube embedded videos.</p>
<p>Sites with tens of thousands of html files can lead to long processing times. This shouldn’t cause the deploy to fail, but even a "quick” manual deploy can take quite awhile (many minutes) to finish if you have tens of thousands of files.</p>
<h2 id="post-processing"><a href="https://docs.netlify.com/configure-builds/troubleshooting-tips/?_ga=2.84803921.938315912.1639898242-345723907.1639767886#post-processing">#</a>Post processing</h2>
<p>There are some situations during build that may lead to a failure in post processing — many things that fail will lead to a retry; if after 4 retries it still hasn’t worked, we fail the deploy. You’ll probably need to <a href="https://www.netlify.com/support/">contact support</a> in this case to get more details about the error, unless you want to follow the next bullet point’s advice.</p>
<p>You may try disabling asset optimization (in Site settings &gt; Build &amp; deploy &gt; Post processing &gt; Asset optimization) if your site fails deploy during post processing or some of your assets end up with nonsense paths on the portion of our CDN hosted on Amazon CloudFront. For instance, if you find an incorrect CloudFront URL with a <code>{$rootfolder}</code> component in it, you’ll need to disable CSS bundling and minification to work around this, or review your CSS as there is likely an incorrect reference causing the behavior.</p>
<p>Redirects or Custom header rules that we can’t process at all are mentioned near the end of the build log and in the Deploy Summary for a deploy, but will not cause the build or deploy to fail.</p>
<h2 id="build-cache"><a href="https://docs.netlify.com/configure-builds/troubleshooting-tips/?_ga=2.84803921.938315912.1639898242-345723907.1639767886#build-cache">#</a>Build cache</h2>
<p>In order to make builds run faster, we cache certain directories created when we <a href="https://docs.netlify.com/configure-builds/manage-dependencies/#dependency-cache">install your dependencies</a>.</p>
<p>If a build fails, it’s worth retrying with a cleared build cache to check if this works better. You can do this by selecting the Retry deploy button in the header of a failed deploy log page, and then selecting Clear cache and deploy site.</p>
<p><img src="https://d33wubrfki0l68.cloudfront.net/6b862d5d0fe47bb42d9c0582f25dec8d7f47e4b5/00d94/images/configure-builds-retry-deploy-dropdown.png" /></p>
<h2 id="enqueued-builds"><a href="https://docs.netlify.com/configure-builds/troubleshooting-tips/?_ga=2.84803921.938315912.1639898242-345723907.1639767886#enqueued-builds">#</a>Enqueued builds</h2>
<p>Builds may be enqueued for any of the three reasons described below. Visit our Forums for a verified Support Guide on reducing build queueing by <a href="https://answers.netlify.com/t/common-issue-how-can-i-optimize-my-netlify-build-time/3907">optimizing <em>what</em> you build</a>.</p>
<ul>
<li>System queue: Builds enter a system queue when the number of builds across all customers exceeds the current capacity on the build network. This triggers an increase in system capacity, so enqueued builds may start building as capacity increases as well as when other builds complete. To learn how to reduce your team’s exposure to system build queues, <a href="https://www.netlify.com/enterprise/contact/">contact sales</a>.</li>
<li>Team queue: Builds enter your team queue when the number of concurrent builds across all sites on your team exceeds your team’s <a href="https://docs.netlify.com/accounts-and-billing/billing/#builds-usage">build capacity</a>. Such builds appear in your team’s <a href="https://docs.netlify.com/monitor-sites/monitor-builds/">Builds page</a> with the label: Enqueued: Awaiting Capacity. You can select the Manage build capacity button on that page to increase team build capacity. If you have a build that you’d like to build right away, you can <a href="https://docs.netlify.com/monitor-sites/monitor-builds/#prioritize-a-build">prioritize</a> it. <em>(This feature may not be available on all <a href="https://www.netlify.com/pricing/">plans</a>.)</em> You can also <a href="https://docs.netlify.com/site-deploys/manage-deploys/#cancel-a-deploy">cancel</a> unneeded team builds to move other builds up in the queue.</li>
<li>Context queue: When multiple builds are triggered on the same site, in an <em>identical</em> <a href="https://docs.netlify.com/site-deploys/overview/#deploy-contexts">deploy context</a> (such as the same Deploy Preview number, or the same branch deploy) these builds enter a context queue to ensure they complete sequentially. When the current build completes, the newest enqueued build of identical context begins, skipping any others in the same context queue. To start the newest enqueued build in a given context, you can <a href="https://docs.netlify.com/site-deploys/manage-deploys/#cancel-a-deploy">cancel</a> the current active build of identical context.</li>
</ul>
<h2 id="deploy-previews-and-bitbucket"><a href="https://docs.netlify.com/configure-builds/troubleshooting-tips/?_ga=2.84803921.938315912.1639898242-345723907.1639767886#deploy-previews-and-bitbucket">#</a>Deploy Previews and Bitbucket</h2>
<p>Due to limitations with Bitbucket’s API, we cannot build Deploy Previews for pull requests on Bitbucket repositories. This is specifically due to the fact that they do not send complete refs in their webhooks for pull requests. Bitbucket has an <a href="https://bitbucket.org/site/master/issues/5814/refify-pull-requests-by-making-them-a-ref">open issue</a> about this.</p>
<h2 id="more-resources"><a href="https://docs.netlify.com/configure-builds/troubleshooting-tips/?_ga=2.84803921.938315912.1639898242-345723907.1639767886#more-resources">#</a>More resources</h2>
<p>Though our build environment works for most build pipelines, there are a few special cases that may cause you some difficulty. To get more context on how our builds work, check out <a href="https://www.netlify.com/blog/2016/10/18/how-our-build-bots-build-sites/">this blog post on how our build bots build your site</a>. You can also test your build locally using our open source <a href="https://github.com/netlify/build-image">build image</a>.</p>
<p>If your issue doesn’t seem to be addressed above, you can visit our <a href="https://answers.netlify.com/categories">Support Forums</a> to browse posts about common issues or start a new discussion. Many questions about specific build scenarios have also been <a href="https://stackoverflow.com/questions/tagged/netlify">asked and answered on StackOverflow</a>.</p>
</body>
</html>
