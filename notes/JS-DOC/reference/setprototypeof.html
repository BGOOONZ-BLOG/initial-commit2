<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>setprototypeof</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<h1 id="object.setprototypeof">Object.setPrototypeOf()</h1>
<p>The <code>Object.setPrototypeOf()</code> method sets the prototype (i.e., the internal <code>[[Prototype]]</code> property) of a specified object to another object or <a href="../null"><code>null</code></a>.</p>
<p><strong>Warning:</strong> Changing the <code>[[Prototype]]</code> of an object is, by the nature of <a href="https://mathiasbynens.be/notes/prototypes">how modern JavaScript engines optimize property accesses</a>, currently a very slow operation in every browser and JavaScript engine. In addition, the effects of altering inheritance are subtle and far-flung, and are not limited to the time spent in the <code>Object.setPrototypeOf(...)</code> statement, but may extend to <strong><em>any</em></strong> code that has access to any object whose <code>[[Prototype]]</code> has been altered.</p>
<p>Because this feature is a part of the language, it is still the burden on engine developers to implement that feature performantly (ideally). Until engine developers address this issue, if you are concerned about performance, you should avoid setting the <code>[[Prototype]]</code> of an object. Instead, create a new object with the desired <code>[[Prototype]]</code> using <a href="create"><code>Object.create()</code></a>.</p>
<h2 id="syntax">Syntax</h2>
<pre><code>Object.setPrototypeOf(obj, prototype)</code></pre>
<h3 id="parameters">Parameters</h3>
<p><code>obj</code><br />
The object which is to have its prototype set.</p>
<p><code>prototype</code><br />
The object’s new prototype (an object or <a href="../null"><code>null</code></a>).</p>
<h3 id="return-value">Return value</h3>
<p>The specified object.</p>
<h2 id="description">Description</h2>
<p>Throws a <a href="../typeerror"><code>TypeError</code></a> exception if the object whose <code>[[Prototype]]</code> is to be modified is non-extensible according to <a href="isextensible"><code>Object.isExtensible()</code></a>. Does nothing if the <code>prototype</code> parameter isn’t an object or <a href="../null"><code>null</code></a> (i.e., number, string, boolean, or <a href="../undefined"><code>undefined</code></a>). Otherwise, this method changes the <code>[[Prototype]]</code> of <code>obj</code> to the new value.</p>
<p><code>Object.setPrototypeOf()</code> is in the ECMAScript 2015 specification. It is generally considered the proper way to set the prototype of an object, vs. the more controversial <a href="proto"><code>Object.prototype.__proto__</code></a> property.</p>
<h2 id="appending-prototype-chains">Appending Prototype Chains</h2>
<p>A combination of <code>Object.getPrototypeOf()</code> and <a href="proto"><code>Object.prototype.__proto__</code></a> permits appending a whole prototype chain to a new prototype object:</p>
<pre><code>/**
*** Object.appendChain(@object, @prototype)
*
* Appends the first non-native prototype of a chain to a new prototype.
* Returns @object (if it was a primitive value it will transformed into an object).
*
*** Object.appendChain(@object [, &quot;@arg_name_1&quot;, &quot;@arg_name_2&quot;, &quot;@arg_name_3&quot;, &quot;...&quot;], &quot;@function_body&quot;)
*** Object.appendChain(@object [, &quot;@arg_name_1, @arg_name_2, @arg_name_3, ...&quot;], &quot;@function_body&quot;)
*
* Appends the first non-native prototype of a chain to the native Function.prototype object, then appends a
* new Function([&quot;@arg&quot;(s)], &quot;@function_body&quot;) to that chain.
* Returns the function.
*
**/

Object.appendChain = function(oChain, oProto) {
  if (arguments.length &lt; 2) {
    throw new TypeError(&#39;Object.appendChain - Not enough arguments&#39;);
  }
  if (typeof oProto !== &#39;object&#39; &amp;&amp; typeof oProto !== &#39;string&#39;) {
    throw new TypeError(&#39;second argument to Object.appendChain must be an object or a string&#39;);
  }

  var oNewProto = oProto,
      oReturn = o2nd = oLast = oChain instanceof this ? oChain : new oChain.constructor(oChain);

  for (var o1st = this.getPrototypeOf(o2nd);
    o1st !== Object.prototype &amp;&amp; o1st !== Function.prototype;
    o1st = this.getPrototypeOf(o2nd)
  ) {
    o2nd = o1st;
  }

  if (oProto.constructor === String) {
    oNewProto = Function.prototype;
    oReturn = Function.apply(null, Array.prototype.slice.call(arguments, 1));
    this.setPrototypeOf(oReturn, oLast);
  }

  this.setPrototypeOf(o2nd, oNewProto);
  return oReturn;
}</code></pre>
<h3 id="usage">Usage</h3>
<h4 id="first-example-appending-a-chain-to-a-prototype">First example: Appending a chain to a prototype</h4>
<pre><code>function Mammal() {
  this.isMammal = &#39;yes&#39;;
}

function MammalSpecies(sMammalSpecies) {
  this.species = sMammalSpecies;
}

MammalSpecies.prototype = new Mammal();
MammalSpecies.prototype.constructor = MammalSpecies;

var oCat = new MammalSpecies(&#39;Felis&#39;);

console.log(oCat.isMammal); // &#39;yes&#39;

function Animal() {
  this.breathing = &#39;yes&#39;;
}

Object.appendChain(oCat, new Animal());

console.log(oCat.breathing); // &#39;yes&#39;</code></pre>
<h4 id="second-example-transforming-a-primitive-value-into-an-instance-of-its-constructor-and-append-its-chain-to-a-prototype">Second example: Transforming a primitive value into an instance of its constructor and append its chain to a prototype</h4>
<pre><code>function MySymbol() {
  this.isSymbol = &#39;yes&#39;;
}

var nPrime = 17;

console.log(typeof nPrime); // &#39;number&#39;

var oPrime = Object.appendChain(nPrime, new MySymbol());

console.log(oPrime); // &#39;17&#39;
console.log(oPrime.isSymbol); // &#39;yes&#39;
console.log(typeof oPrime); // &#39;object&#39;</code></pre>
<h4 id="third-example-appending-a-chain-to-the-function.prototype-object-and-appending-a-new-function-to-that-chain">Third example: Appending a chain to the Function.prototype object and appending a new function to that chain</h4>
<pre><code>function Person(sName) {
  this.identity = sName;
}

var george = Object.appendChain(new Person(&#39;George&#39;),
                                &#39;console.log(&quot;Hello guys!!&quot;);&#39;);

console.log(george.identity); // &#39;George&#39;
george(); // &#39;Hello guys!!&#39;</code></pre>
<h2 id="examples">Examples</h2>
<h3 id="using-object.setprototypeof">Using Object.setPrototypeOf</h3>
<pre><code>var dict = Object.setPrototypeOf({}, null);</code></pre>
<h2 id="polyfill">Polyfill</h2>
<p>Using the older <a href="proto"><code>Object.prototype.__proto__</code></a> property, we can easily define <code>Object.setPrototypeOf</code> if it isn’t available already:</p>
<pre><code>if (!Object.setPrototypeOf) {
    // Only works in Chrome and FireFox, does not work in IE:
     Object.prototype.setPrototypeOf = function(obj, proto) {
         if(obj.__proto__) {
             obj.__proto__ = proto;
             return obj;
         } else {
             // If you want to return prototype of Object.create(null):
             var Fn = function() {
                 for (var key in obj) {
                     Object.defineProperty(this, key, {
                         value: obj[key],
                     });
                 }
             };
             Fn.prototype = proto;
             return new Fn();
         }
     }
}</code></pre>
<h2 id="specifications">Specifications</h2>
<table>
<thead>
<tr class="header">
<th>
Specification
</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>
<p><a href="https://tc39.es/ecma262/#sec-object.setprototypeof">ECMAScript Language Specification (ECMAScript) <br/></p>
<span class="small">#sec-object.setprototypeof</span></a>
</td>
</tr>
</tbody>
</table>
<h2 id="browser-compatibility">Browser compatibility</h2>
<p>Desktop</p>
<p>Mobile</p>
<p>Chrome</p>
<p>Edge</p>
<p>Firefox</p>
<p>Internet Explorer</p>
<p>Opera</p>
<p>Safari</p>
<p>WebView Android</p>
<p>Chrome Android</p>
<p>Firefox for Android</p>
<p>Opera Android</p>
<p>Safari on IOS</p>
<p>Samsung Internet</p>
<p><code>setPrototypeOf</code></p>
<p>34</p>
<p>12</p>
<p>31</p>
<p>11</p>
<p>21</p>
<p>9</p>
<p>37</p>
<p>34</p>
<p>31</p>
<p>21</p>
<p>9</p>
<p>2.0</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="../reflect/setprototypeof"><code>Reflect.setPrototypeOf()</code></a></li>
<li><a href="isprototypeof"><code>Object.prototype.isPrototypeOf()</code></a></li>
<li><a href="getprototypeof"><code>Object.getPrototypeOf()</code></a></li>
<li><a href="proto"><code>Object.prototype.__proto__</code></a></li>
</ul>
<p>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br />
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/setPrototypeOf" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/setPrototypeOf</a></p>
</body>
</html>
